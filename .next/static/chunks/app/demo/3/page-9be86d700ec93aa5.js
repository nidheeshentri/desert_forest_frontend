(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8125],{85474:function(e,n,a){Promise.resolve().then(a.bind(a,28936))},28936:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return g}});var l=a(57437),s=a(2265),r=a(29501),t=a(15452),c=a.n(t),i=a(83464),d=a(40257);let o=i.Z.create({headers:{Authorization:"Bearer ".concat(d.env.NEXT_PUBLIC_WHATSAPP_ACCESS_TOKEN),"Content-Type":"application/json"}});var m=a(79820),h=a(12381),p=a(40279),x=a(15291),j=a(80670);let u=[{id:"1",name:"Template 1",content:"This is the content of template 1"},{id:"2",name:"Template 2",content:"This is the content of template 2"},{id:"2",name:"Template 2",content:"This is the content of template 2"}];var g=()=>{let[e,n]=(0,s.useState)([]),a=(0,r.cI)({defaultValues:{name:"",message:"",audience:"",template:""}}),{handleSubmit:t,control:i,reset:d,watch:g,setValue:f}=a,v=g("template");(0,s.useEffect)(()=>{},[]),(0,s.useEffect)(()=>{if(v){let e=u.find(e=>e.id===v);e&&f("message",e.content)}},[v,f]);let C=async e=>{try{let n=[{type:"BODY",text:e.message}];await o.post("/api/whatsapp/createTemplate",{name:e.name,language:"en_US",components:n}),d()}catch(e){var n;console.error("Error creating template:",(null===(n=e.response)||void 0===n?void 0:n.data)||e.message),alert("Failed to create campaign template")}};return(0,l.jsx)("div",{className:"min-h-screen p-8 bg-gray-100",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[(0,l.jsxs)(m.Zb,{className:"col-span-1 lg:col-span-3",children:[(0,l.jsx)(m.Ol,{children:(0,l.jsx)(m.ll,{children:"Create Campaign"})}),(0,l.jsx)(m.aY,{children:(0,l.jsx)(r.RV,{...a,children:(0,l.jsxs)("form",{onSubmit:t(C),children:[(0,l.jsxs)(j.xJ,{children:[(0,l.jsx)(j.lX,{htmlFor:"name",children:"Campaign Name"}),(0,l.jsx)(j.NI,{children:(0,l.jsx)(r.Qr,{name:"name",control:i,render:e=>{let{field:n}=e;return(0,l.jsx)(p.I,{...n,placeholder:"Enter campaign name",required:!0})}})})]}),(0,l.jsxs)(j.xJ,{children:[(0,l.jsx)(j.lX,{htmlFor:"template",children:"Template"}),(0,l.jsx)(j.NI,{children:(0,l.jsx)(r.Qr,{name:"template",control:i,render:e=>{let{field:n}=e;return(0,l.jsxs)(x.Ph,{value:n.value,onValueChange:n.onChange,required:!0,children:[(0,l.jsx)(x.i4,{children:(0,l.jsx)(x.ki,{placeholder:"Select template"})}),(0,l.jsx)(x.Bw,{children:u.map(e=>(0,l.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]})}})})]}),(0,l.jsxs)(j.xJ,{children:[(0,l.jsx)(j.lX,{htmlFor:"message",children:"Message"}),(0,l.jsx)(j.NI,{children:(0,l.jsx)(r.Qr,{name:"message",control:i,render:e=>{let{field:n}=e;return(0,l.jsx)(p.I,{...n,placeholder:"Enter campaign message",required:!0})}})})]}),(0,l.jsxs)(j.xJ,{children:[(0,l.jsx)(j.lX,{htmlFor:"audience",children:"Audience"}),(0,l.jsx)(j.NI,{children:(0,l.jsx)(r.Qr,{name:"audience",control:i,render:n=>{let{field:a}=n;return(0,l.jsxs)(x.Ph,{value:a.value,onValueChange:a.onChange,required:!0,children:[(0,l.jsx)(x.i4,{children:(0,l.jsx)(x.ki,{placeholder:"Select audience"})}),(0,l.jsx)(x.Bw,{children:e.map((e,n)=>(0,l.jsx)(x.Ql,{value:e.name,children:e.name},n))})]})}})})]}),(0,l.jsx)(h.z,{type:"submit",children:"Create Campaign"})]})})})]}),(0,l.jsxs)(m.Zb,{className:"col-span-1 lg:col-span-3",children:[(0,l.jsx)(m.Ol,{children:(0,l.jsx)(m.ll,{children:"Manage Campaigns"})}),(0,l.jsx)(m.aY,{children:(0,l.jsx)("p",{children:"No campaigns available"})})]}),(0,l.jsxs)(m.Zb,{className:"col-span-1 lg:col-span-3",children:[(0,l.jsx)(m.Ol,{children:(0,l.jsx)(m.ll,{children:"Import Contacts"})}),(0,l.jsx)(m.aY,{children:(0,l.jsx)("input",{type:"file",accept:".csv",onChange:a=>{var l;let s=null===(l=a.target.files)||void 0===l?void 0:l[0];s&&c().parse(s,{complete:a=>{let l=a.data.map(e=>e[0]),s=prompt("Please enter a name for the new audience");s&&n([...e,{name:s,contacts:l}])}})}})})]})]})})}}},function(e){e.O(0,[7037,1182,3464,4237,9501,6075,2971,2117,1744],function(){return e(e.s=85474)}),_N_E=e.O()}]);